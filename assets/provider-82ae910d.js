var T=Object.defineProperty;var P=(s,t,e)=>t in s?T(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var r=(s,t,e)=>(P(s,typeof t!="symbol"?t+"":t,e),e);import{w as o,x as f,y as h,z as k,A as L,B as c,E as d,F as g,D as E,G as v,H as l}from"./index-a3f5c435.js";import{H as I,P as M}from"./provider-8ddf769a.js";class A{constructor(t,e){this.l=t,this.Ha=e,t.textTracks.onaddtrack=this.o.bind(this),o(this.La.bind(this))}o(t){const e=t.track;if(!e||x(this.l,e))return;const i=new f({id:e.id,kind:e.kind,label:e.label,language:e.language,type:"vtt"});i[h]={track:e},i[k]=2,i[L]=!0;let n=0;const u=p=>{if(e.cues)for(let a=n;a<e.cues.length;a++)i.addCue(e.cues[a],p),n++};u(t),e.oncuechange=u,this.Ha.textTracks.add(i,t),i.setMode(e.mode,t)}La(){var t;this.l.textTracks.onaddtrack=null;for(const e of this.Ha.textTracks){const i=(t=e[h])==null?void 0:t.track;i!=null&&i.oncuechange&&(i.oncuechange=null)}}}function x(s,t){return Array.from(s.children).find(e=>e.track===t)}class w{constructor(t,e){r(this,"O",(t,e)=>{this.e.delegate.L("picture-in-picture-change",{detail:t,trigger:e})});this.l=t,this.e=e,c(this.l,"enterpictureinpicture",this.La.bind(this)),c(this.l,"leavepictureinpicture",this.Ma.bind(this))}get active(){return document.pictureInPictureElement===this.l}get supported(){return d(this.l)}async enter(){return this.l.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}La(t){this.O(!0,t)}Ma(t){this.O(!1,t)}}class y{constructor(t,e){r(this,"g","inline");this.l=t,this.e=e,c(this.l,"webkitpresentationmodechanged",this.Oa.bind(this))}get Na(){return g(this.l)}async Ma(t){this.g!==t&&this.l.webkitSetPresentationMode(t)}Oa(){var e;const t=this.g;this.g=this.l.webkitPresentationMode,(e=this.e.player)==null||e.dispatchEvent(new E("video-presentation-change",{detail:this.g,trigger:event})),["fullscreen","picture-in-picture"].forEach(i=>{(this.g===i||t===i)&&this.e.delegate.L(`${i}-change`,{detail:this.g===i,trigger:event})})}}class b{constructor(t){this.La=t}get active(){return this.La.g==="fullscreen"}get supported(){return this.La.Na}async enter(){this.La.Ma("fullscreen")}async exit(){this.La.Ma("inline")}}class m{constructor(t){this.La=t}get active(){return this.La.g==="picture-in-picture"}get supported(){return this.La.Na}async enter(){this.La.Ma("picture-in-picture")}async exit(){this.La.Ma("inline")}}var H;class R extends I{constructor(e,i){super(e);r(this,H,"VIDEO");r(this,"fullscreen");r(this,"pictureInPicture");if(g(e)){const n=new y(e,i);this.fullscreen=new b(n),this.pictureInPicture=new m(n)}else d(e)&&(this.pictureInPicture=new w(e,i))}get type(){return"video"}setup(e){super.setup(e),v(this.video)&&new A(this.video,e),e.textRenderers[l](this.video),o(()=>{e.textRenderers[l](null)}),this.type==="video"&&e.delegate.j("provider-setup",{detail:this})}get video(){return this.d}}H=M;export{R as VideoProvider};
